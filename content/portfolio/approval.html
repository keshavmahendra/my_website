---
categories:
- ""
- ""
date: "2017-10-31T22:26:09-05:00"
description:
draft: false
image: knitr::include_graphics("/img/portfolio/biden_approval_margin.jpg",error =FALSE)
keywords: ""
slug: approval
title: Joe Biden's Approval Rating over time
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="downloading-and-cleaning-data" class="section level1">
<h1>Downloading and cleaning data</h1>
<pre class="r"><code># Importing approval polls data directly off fivethirtyeight website
approval_polllist &lt;- read_csv(&#39;https://projects.fivethirtyeight.com/biden-approval-data/approval_polllist.csv&#39;) 

glimpse(approval_polllist) #taking a look at the data</code></pre>
<pre><code>## Rows: 1,947
## Columns: 22
## $ president           &lt;chr&gt; &quot;Joseph R. Biden Jr.&quot;, &quot;Joseph R. Biden Jr.&quot;, &quot;Jos…
## $ subgroup            &lt;chr&gt; &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;…
## $ modeldate           &lt;chr&gt; &quot;10/20/2021&quot;, &quot;10/20/2021&quot;, &quot;10/20/2021&quot;, &quot;10/20/2…
## $ startdate           &lt;chr&gt; &quot;1/19/2021&quot;, &quot;1/19/2021&quot;, &quot;1/20/2021&quot;, &quot;1/20/2021&quot;…
## $ enddate             &lt;chr&gt; &quot;1/21/2021&quot;, &quot;1/21/2021&quot;, &quot;1/21/2021&quot;, &quot;1/21/2021&quot;…
## $ pollster            &lt;chr&gt; &quot;Rasmussen Reports/Pulse Opinion Research&quot;, &quot;Morni…
## $ grade               &lt;chr&gt; &quot;B&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B+&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;B&quot;, &quot;B…
## $ samplesize          &lt;dbl&gt; 1500, 15000, 1115, 1993, 15000, 1516, 15000, 1200,…
## $ population          &lt;chr&gt; &quot;lv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;lv&quot;, &quot;…
## $ weight              &lt;dbl&gt; 0.3382, 0.2594, 1.1014, 0.0930, 0.2333, 1.2454, 0.…
## $ influence           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ approve             &lt;dbl&gt; 48, 50, 55, 56, 51, 45, 52, 58, 48, 63, 48, 55, 53…
## $ disapprove          &lt;dbl&gt; 45, 28, 32, 31, 28, 28, 29, 32, 47, 37, 47, 33, 29…
## $ adjusted_approve    &lt;dbl&gt; 50.4, 48.5, 53.8, 54.5, 49.5, 46.4, 50.5, 56.9, 50…
## $ adjusted_disapprove &lt;dbl&gt; 38.8, 31.2, 33.0, 34.2, 31.2, 28.5, 32.2, 33.1, 40…
## $ multiversions       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ tracking            &lt;lgl&gt; TRUE, TRUE, NA, NA, TRUE, NA, TRUE, NA, TRUE, NA, …
## $ url                 &lt;chr&gt; &quot;https://www.rasmussenreports.com/public_content/p…
## $ poll_id             &lt;dbl&gt; 74247, 74272, 74248, 74246, 74273, 74327, 74274, 7…
## $ question_id         &lt;dbl&gt; 139395, 139491, 139404, 139394, 139492, 139570, 13…
## $ createddate         &lt;chr&gt; &quot;1/22/2021&quot;, &quot;1/28/2021&quot;, &quot;1/22/2021&quot;, &quot;1/22/2021&quot;…
## $ timestamp           &lt;chr&gt; &quot;20:39:09 20 Oct 2021&quot;, &quot;20:39:09 20 Oct 2021&quot;, &quot;2…</code></pre>
<p>The date variables are given as characters and need to be formatted as dates</p>
<pre class="r"><code>#using `lubridate` to fix dates, as they are given as characters.
approval_polllist$modeldate&lt;-mdy(approval_polllist$modeldate)
approval_polllist$startdate&lt;-mdy(approval_polllist$startdate)
approval_polllist$enddate&lt;-mdy(approval_polllist$enddate)
approval_polllist$createddate &lt;-mdy(approval_polllist$createddate )
approval_polllist$timestamp   &lt;-as_datetime(approval_polllist$createddate )
glimpse(approval_polllist) #checking that it was fixed</code></pre>
<pre><code>## Rows: 1,947
## Columns: 22
## $ president           &lt;chr&gt; &quot;Joseph R. Biden Jr.&quot;, &quot;Joseph R. Biden Jr.&quot;, &quot;Jos…
## $ subgroup            &lt;chr&gt; &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;…
## $ modeldate           &lt;date&gt; 2021-10-20, 2021-10-20, 2021-10-20, 2021-10-20, 2…
## $ startdate           &lt;date&gt; 2021-01-19, 2021-01-19, 2021-01-20, 2021-01-20, 2…
## $ enddate             &lt;date&gt; 2021-01-21, 2021-01-21, 2021-01-21, 2021-01-21, 2…
## $ pollster            &lt;chr&gt; &quot;Rasmussen Reports/Pulse Opinion Research&quot;, &quot;Morni…
## $ grade               &lt;chr&gt; &quot;B&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B+&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;B&quot;, &quot;B…
## $ samplesize          &lt;dbl&gt; 1500, 15000, 1115, 1993, 15000, 1516, 15000, 1200,…
## $ population          &lt;chr&gt; &quot;lv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;lv&quot;, &quot;…
## $ weight              &lt;dbl&gt; 0.3382, 0.2594, 1.1014, 0.0930, 0.2333, 1.2454, 0.…
## $ influence           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ approve             &lt;dbl&gt; 48, 50, 55, 56, 51, 45, 52, 58, 48, 63, 48, 55, 53…
## $ disapprove          &lt;dbl&gt; 45, 28, 32, 31, 28, 28, 29, 32, 47, 37, 47, 33, 29…
## $ adjusted_approve    &lt;dbl&gt; 50.4, 48.5, 53.8, 54.5, 49.5, 46.4, 50.5, 56.9, 50…
## $ adjusted_disapprove &lt;dbl&gt; 38.8, 31.2, 33.0, 34.2, 31.2, 28.5, 32.2, 33.1, 40…
## $ multiversions       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ tracking            &lt;lgl&gt; TRUE, TRUE, NA, NA, TRUE, NA, TRUE, NA, TRUE, NA, …
## $ url                 &lt;chr&gt; &quot;https://www.rasmussenreports.com/public_content/p…
## $ poll_id             &lt;dbl&gt; 74247, 74272, 74248, 74246, 74273, 74327, 74274, 7…
## $ question_id         &lt;dbl&gt; 139395, 139491, 139404, 139394, 139492, 139570, 13…
## $ createddate         &lt;date&gt; 2021-01-22, 2021-01-28, 2021-01-22, 2021-01-22, 2…
## $ timestamp           &lt;dttm&gt; 2021-01-22, 2021-01-28, 2021-01-22, 2021-01-22, 2…</code></pre>
</div>
<div id="creating-a-plot" class="section level1">
<h1>Creating a plot</h1>
<p>We are creating a plot showing Joe Biden’s net approval margin over time alond with its 95% confidence interval. The plot we are trying to recreate:
<img src="/Users/Keshav/Desktop/my_website/static/img/portfolio/biden_approval_margin.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>Now we shall use <code>ggplot</code> and its nuances on our dataset to replicate the above graph.</p>
<pre class="r"><code>approval_polllist_ci&lt;-approval_polllist %&gt;%
  mutate(week_of_the_year=week(enddate),net_approval_rate=approve-disapprove)%&gt;% #calculating the net approval rating
  filter(subgroup==&quot;All polls&quot;) %&gt;% #filtering for all polls
  group_by(week_of_the_year)%&gt;% #grouping by week
  summarize(average_net_approval_rate=mean(net_approval_rate),
            sd_net_approval_rate=sd(net_approval_rate),
            count=n(),
            se_net_approval_rate=sd_net_approval_rate/sqrt(count),
            t_critical=qt(0.975,count-1),
             margin_of_error=t_critical*se_net_approval_rate,
            lower_ci_95=average_net_approval_rate-t_critical*se_net_approval_rate,
            higher_ci_95=average_net_approval_rate+t_critical*se_net_approval_rate,
            na.rm=TRUE) %&gt;% #calculating the confidence intervals for each week
  ggplot(aes(x=week_of_the_year,y=average_net_approval_rate))+ #building the plot
  geom_point(colour=&quot;red3&quot;,size=0.2,xlim=40)+ #plotting each data point
  geom_line(colour=&quot;red3&quot;,size=0.1)+ #adding a line that links the data points
  theme_bw()+
  geom_smooth(se=FALSE,legend.position=NA,colour=&quot;blue&quot;,size=0.4)+ #adding a trendline
  geom_ribbon(aes(ymin=lower_ci_95,ymax=higher_ci_95),colour=&quot;red3&quot;,alpha=0.1,linetype=&quot;dashed&quot;,size=0.1)+ #colouring the CI
  geom_hline(aes(yintercept=0),size=0.8,colour=&quot;orange&quot;)+ #adding a horizontal line on the y=0 axis
  theme(legend.position = &quot;none&quot;, #setting a more easily readable theme
        legend.background=element_blank(),
        plot.title=element_text(size=10,face=&quot;bold&quot;),
        axis.ticks=element_blank(),
        axis.text=element_text(size=5),
        strip.text=element_text(size=6),
        axis.title=element_text(size=6,face=&quot;bold&quot;),
        plot.subtitle=element_text(size=8,face=&quot;bold&quot;),
        panel.border = element_blank(),
        aspect.ratio=1377/2500)+
  scale_y_continuous(expand = c(0, 1), breaks= seq(-15,10,by=2.5),limits=c(-15,40))+ #setting y-axis boundaries to make the data more readable
  scale_x_continuous(expand = c(0, 0),breaks= seq(0,40,by=13),limits=c(1,40))+ #setting x-axis boundaries to make the data more readable
    labs(title=&quot;Estimating Approval Margin (Approve - Disapprove) for Joe Biden&quot;, 
       subtitle=&quot;Weekly Average of All Polls&quot;,
       x=&quot;Week of the year&quot;, 
       y=&quot;Average Approval Margin (approve-disapprove)&quot;)+
  annotate(&quot;text&quot;,x=20,y=40,label=&quot;2021&quot;,size=2)

approval_polllist_ci #printing to view the plot</code></pre>
<p><img src="/portfolio/approval_files/figure-html/poll_plot-1.png" width="648" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-confidence-intervals" class="section level1">
<h1>Comparing Confidence Intervals</h1>
<p>The confidence intervals for <code>week 3</code> is very wide compared to the other weeks, whereas the confidence interval for <code>week 25</code> is narrower. The reason the confidence interval for week 3 is wide is because it is the first week we have data for and our data starts in the middle of the week. Week 3 in 2021 was from 18-24. January. The ‘enddate’ variable from the data set that we use to plot the weeks only starts from January 21st. Therefore, we believe the number of data points in week 3 to be much lower than in other weeks, leading to a wider confidence interval.</p>
</div>
